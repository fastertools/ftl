{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "FtlConfig",
  "description": "Root configuration structure for ftl.toml",
  "type": "object",
  "required": ["project"],
  "properties": {
    "project": {
      "description": "Project metadata",
      "$ref": "#/$defs/ProjectConfig"
    },
    "auth": {
      "description": "Authentication configuration",
      "$ref": "#/$defs/AuthConfig",
      "default": {
        "enabled": false,
        "provider": "",
        "issuer": "",
        "audience": ""
      }
    },
    "tools": {
      "description": "Tool definitions",
      "type": "object",
      "additionalProperties": {
        "$ref": "#/$defs/ToolConfig"
      },
      "default": {}
    },
    "deployment": {
      "description": "Deployment configuration",
      "$ref": "#/$defs/DeploymentConfig",
      "default": {
        "registry": "",
        "package": "",
        "tag": ""
      }
    },
    "gateway": {
      "description": "Gateway component configuration",
      "$ref": "#/$defs/GatewayConfig",
      "default": {
        "version": "",
        "authorizer_version": "",
        "validate_arguments": true
      }
    }
  },
  "$defs": {
    "ProjectConfig": {
      "description": "Project metadata",
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": {
          "description": "Project name (alphanumeric, hyphens, underscores only, must start with letter)",
          "type": "string",
          "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$"
        },
        "version": {
          "description": "Semantic version (e.g., 0.1.0)",
          "type": "string",
          "default": "0.1.0"
        },
        "description": {
          "description": "Project description",
          "type": "string",
          "default": ""
        },
        "authors": {
          "description": "Project authors",
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": []
        }
      }
    },
    "AuthConfig": {
      "description": "Authentication configuration",
      "type": "object",
      "properties": {
        "enabled": {
          "description": "Enable authentication for this MCP server",
          "type": "boolean",
          "default": false
        },
        "provider": {
          "description": "Authentication provider type",
          "type": "string",
          "default": ""
        },
        "issuer": {
          "description": "OIDC issuer URL",
          "type": "string",
          "default": ""
        },
        "audience": {
          "description": "Expected audience for tokens",
          "type": "string",
          "default": ""
        },
        "oidc": {
          "description": "OIDC-specific configuration",
          "$ref": "#/$defs/OidcConfig"
        }
      }
    },
    "OidcConfig": {
      "description": "OIDC-specific configuration",
      "type": "object",
      "required": ["provider_name", "jwks_uri", "authorize_endpoint", "token_endpoint", "userinfo_endpoint", "allowed_domains"],
      "properties": {
        "provider_name": {
          "description": "Display name for the OIDC provider",
          "type": "string"
        },
        "jwks_uri": {
          "description": "JWKS endpoint URL",
          "type": "string"
        },
        "authorize_endpoint": {
          "description": "Authorization endpoint URL",
          "type": "string"
        },
        "token_endpoint": {
          "description": "Token endpoint URL",
          "type": "string"
        },
        "userinfo_endpoint": {
          "description": "Userinfo endpoint URL",
          "type": "string"
        },
        "allowed_domains": {
          "description": "Comma-separated list of allowed email domains",
          "type": "string"
        }
      }
    },
    "ToolConfig": {
      "description": "Tool configuration",
      "type": "object",
      "required": ["type", "path"],
      "properties": {
        "type": {
          "description": "Tool implementation language",
          "type": "string",
          "pattern": "^(rust|typescript|javascript)$"
        },
        "path": {
          "description": "Path to tool directory (relative to project root)",
          "type": "string"
        },
        "build": {
          "description": "Custom build command",
          "type": "string"
        },
        "allowed_hosts": {
          "description": "Allowed outbound hosts for the tool",
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": []
        },
        "watch": {
          "description": "Watch paths for development mode",
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": []
        }
      }
    },
    "DeploymentConfig": {
      "description": "Deployment configuration",
      "type": "object",
      "properties": {
        "registry": {
          "description": "Registry URL (e.g., 'ghcr.io')",
          "type": "string",
          "default": ""
        },
        "package": {
          "description": "Package name (e.g., 'myorg/my-project')",
          "type": "string",
          "default": ""
        },
        "tag": {
          "description": "Default tag/version for deployment",
          "type": "string",
          "default": ""
        }
      }
    },
    "GatewayConfig": {
      "description": "Gateway component configuration",
      "type": "object",
      "properties": {
        "version": {
          "description": "MCP gateway component version (leave empty for latest)",
          "type": "string",
          "default": ""
        },
        "authorizer_version": {
          "description": "MCP authorizer component version (leave empty for latest)",
          "type": "string",
          "default": ""
        },
        "validate_arguments": {
          "description": "Whether to validate tool arguments",
          "type": "boolean",
          "default": true
        }
      }
    }
  }
}